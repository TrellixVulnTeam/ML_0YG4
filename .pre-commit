#!/bin/sh
# This hook runs the nbconvert command on notes.ipynb or exercises.ipynb files
# in order to auto generate the markdown output in my projects directory.
# TODO: Just auto generate markdown copies within this repo and point
# personal website at them.
files=$(git diff --cached --name-status)
re=".*chapter?.\/((notes.ipynb|exercises.ipynb))"
proj_dir="/Path/to/your/project_dir"
for file in $files; do
  if [[ $file =~ $re ]]; then
    echo $file
    output_file="${file%.*}.md"
    echo "Running... jupyter nbconvert --to markdown $file --output $proj_dir/$output_file"
    if jupyter nbconvert --to markdown $file --output $proj_dir/$output_file; then
      echo "Success: jupyter nbconvert --to markdown $file --output $proj_dir/$output_file"
    else
      echo "Failed: jupyter nbconvert --to markdown $file --output $proj_dir/$output_file"
      exit 1
    fi
  fi
done
